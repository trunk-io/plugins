// Jest Snapshot v1, https://goo.gl/fbAQLP

exports[`Testing linter checkov test basic_kubernetes 1`] = `
{
  "issues": [
    {
      "code": "CKV2_K8S_6",
      "column": "1",
      "file": "test_data/basic_kubernetes.in.yaml",
      "isSecurity": true,
      "level": "LEVEL_HIGH",
      "line": "2",
      "linter": "checkov",
      "message": "Minimize the admission of pods which lack an associated NetworkPolicy",
      "targetType": "yaml",
    },
    {
      "code": "CKV_K8S_10",
      "column": "1",
      "file": "test_data/basic_kubernetes.in.yaml",
      "isSecurity": true,
      "level": "LEVEL_HIGH",
      "line": "2",
      "linter": "checkov",
      "message": "CPU requests should be set",
      "targetType": "yaml",
    },
    {
      "code": "CKV_K8S_11",
      "column": "1",
      "file": "test_data/basic_kubernetes.in.yaml",
      "isSecurity": true,
      "level": "LEVEL_HIGH",
      "line": "2",
      "linter": "checkov",
      "message": "CPU limits should be set",
      "targetType": "yaml",
    },
    {
      "code": "CKV_K8S_12",
      "column": "1",
      "file": "test_data/basic_kubernetes.in.yaml",
      "isSecurity": true,
      "level": "LEVEL_HIGH",
      "line": "2",
      "linter": "checkov",
      "message": "Memory requests should be set",
      "targetType": "yaml",
    },
    {
      "code": "CKV_K8S_13",
      "column": "1",
      "file": "test_data/basic_kubernetes.in.yaml",
      "isSecurity": true,
      "level": "LEVEL_HIGH",
      "line": "2",
      "linter": "checkov",
      "message": "Memory limits should be set",
      "targetType": "yaml",
    },
    {
      "code": "CKV_K8S_14",
      "column": "1",
      "file": "test_data/basic_kubernetes.in.yaml",
      "isSecurity": true,
      "level": "LEVEL_HIGH",
      "line": "2",
      "linter": "checkov",
      "message": "Image Tag should be fixed - not latest or blank",
      "targetType": "yaml",
    },
    {
      "code": "CKV_K8S_20",
      "column": "1",
      "file": "test_data/basic_kubernetes.in.yaml",
      "isSecurity": true,
      "level": "LEVEL_HIGH",
      "line": "2",
      "linter": "checkov",
      "message": "Containers should not run with allowPrivilegeEscalation",
      "targetType": "yaml",
    },
    {
      "code": "CKV_K8S_21",
      "column": "1",
      "file": "test_data/basic_kubernetes.in.yaml",
      "isSecurity": true,
      "level": "LEVEL_HIGH",
      "line": "2",
      "linter": "checkov",
      "message": "The default namespace should not be used",
      "targetType": "yaml",
    },
    {
      "code": "CKV_K8S_22",
      "column": "1",
      "file": "test_data/basic_kubernetes.in.yaml",
      "isSecurity": true,
      "level": "LEVEL_HIGH",
      "line": "2",
      "linter": "checkov",
      "message": "Use read-only filesystem for containers where possible",
      "targetType": "yaml",
    },
    {
      "code": "CKV_K8S_23",
      "column": "1",
      "file": "test_data/basic_kubernetes.in.yaml",
      "isSecurity": true,
      "level": "LEVEL_HIGH",
      "line": "2",
      "linter": "checkov",
      "message": "Minimize the admission of root containers",
      "targetType": "yaml",
    },
    {
      "code": "CKV_K8S_28",
      "column": "1",
      "file": "test_data/basic_kubernetes.in.yaml",
      "isSecurity": true,
      "level": "LEVEL_HIGH",
      "line": "2",
      "linter": "checkov",
      "message": "Minimize the admission of containers with the NET_RAW capability",
      "targetType": "yaml",
    },
    {
      "code": "CKV_K8S_29",
      "column": "1",
      "file": "test_data/basic_kubernetes.in.yaml",
      "isSecurity": true,
      "level": "LEVEL_HIGH",
      "line": "2",
      "linter": "checkov",
      "message": "Apply security context to your pods and containers",
      "targetType": "yaml",
    },
    {
      "code": "CKV_K8S_30",
      "column": "1",
      "file": "test_data/basic_kubernetes.in.yaml",
      "isSecurity": true,
      "level": "LEVEL_HIGH",
      "line": "2",
      "linter": "checkov",
      "message": "Apply security context to your containers",
      "targetType": "yaml",
    },
    {
      "code": "CKV_K8S_31",
      "column": "1",
      "file": "test_data/basic_kubernetes.in.yaml",
      "isSecurity": true,
      "level": "LEVEL_HIGH",
      "line": "2",
      "linter": "checkov",
      "message": "Ensure that the seccomp profile is set to docker/default or runtime/default",
      "targetType": "yaml",
    },
    {
      "code": "CKV_K8S_37",
      "column": "1",
      "file": "test_data/basic_kubernetes.in.yaml",
      "isSecurity": true,
      "level": "LEVEL_HIGH",
      "line": "2",
      "linter": "checkov",
      "message": "Minimize the admission of containers with capabilities assigned",
      "targetType": "yaml",
    },
    {
      "code": "CKV_K8S_38",
      "column": "1",
      "file": "test_data/basic_kubernetes.in.yaml",
      "isSecurity": true,
      "level": "LEVEL_HIGH",
      "line": "2",
      "linter": "checkov",
      "message": "Ensure that Service Account Tokens are only mounted where necessary",
      "targetType": "yaml",
    },
    {
      "code": "CKV_K8S_40",
      "column": "1",
      "file": "test_data/basic_kubernetes.in.yaml",
      "isSecurity": true,
      "level": "LEVEL_HIGH",
      "line": "2",
      "linter": "checkov",
      "message": "Containers should run as a high UID to avoid host conflict",
      "targetType": "yaml",
    },
    {
      "code": "CKV_K8S_43",
      "column": "1",
      "file": "test_data/basic_kubernetes.in.yaml",
      "isSecurity": true,
      "level": "LEVEL_HIGH",
      "line": "2",
      "linter": "checkov",
      "message": "Image should use digest",
      "targetType": "yaml",
    },
    {
      "code": "CKV_K8S_8",
      "column": "1",
      "file": "test_data/basic_kubernetes.in.yaml",
      "isSecurity": true,
      "level": "LEVEL_HIGH",
      "line": "2",
      "linter": "checkov",
      "message": "Liveness Probe Should be Configured",
      "targetType": "yaml",
    },
    {
      "code": "CKV_K8S_9",
      "column": "1",
      "file": "test_data/basic_kubernetes.in.yaml",
      "isSecurity": true,
      "level": "LEVEL_HIGH",
      "line": "2",
      "linter": "checkov",
      "message": "Readiness Probe Should be Configured",
      "targetType": "yaml",
    },
  ],
  "lintActions": [
    {
      "command": "lint",
      "fileGroupName": "yaml",
      "linter": "checkov",
      "paths": [
        "test_data/basic_kubernetes.in.yaml",
      ],
      "verb": "TRUNK_VERB_CHECK",
    },
  ],
  "taskFailures": [],
  "unformattedFiles": [],
}
`;
