version: 0.1
downloads:
  - name: ktlint
    version: 0.43.2
    executable: true
    downloads:
      # Cross-platform download
      - url: https://github.com/pinterest/ktlint/releases/download/${version}/ktlint
tools:
  definitions:
    - name: ktlint
      download: ktlint
      shims: [ktlint]
      known_good_version: 0.43.2
lint:
  definitions:
    - name: ktlint
      supported_platforms: [linux, macos]
      files: [kotlin]
      tools: [ktlint]
      runtime: java
      commands:
        - name: format
          run: ktlint -F "${target}"
          output: rewrite
          cache_results: true
          formatter: true
          in_place: true
          batch: true
          success_codes: [0, 1]
      affects_cache:
        - .editorconfig
      environment:
        - name: LANG
          # C.UTF-8 is preferred for machine output, but mac barfs on that
          value: en_US.UTF-8
      suggest_if: files_present
      known_good_version: 0.43.2
      version_command:
        parse_regex: ${semver}
        run: ktlint --version
