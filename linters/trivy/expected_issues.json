[
  {
    "code": "AVD-AWS-0028",
    "level": "LEVEL_HIGH",
    "linter": "trivy",
    "targetType": "terraform",
    "isSecurity": true,
    "message": "\nIMDS v2 (Instance Metadata Service) introduced session authentication tokens which improve security when talking to IMDS.\nBy default <code>aws_instance</code> resource sets IMDS session auth tokens to be optional. \nTo fully protect IMDS you need to enable session tokens by using <code>metadata_options</code> block and its <code>http_tokens</code> variable set to <code>required</code>.\n",
    "file": "test_data/aws.tf"
  },
  {
    "code": "AVD-AWS-0131",
    "level": "LEVEL_HIGH",
    "linter": "trivy",
    "targetType": "terraform",
    "isSecurity": true,
    "message": "Block devices should be encrypted to ensure sensitive data is held securely at rest.",
    "file": "test_data/aws.tf"
  },
  {
    "code": "DS002",
    "level": "LEVEL_HIGH",
    "linter": "trivy",
    "targetType": "docker",
    "isSecurity": true,
    "message": "Running containers with 'root' user can lead to a container escape situation. It is a best practice to run containers as non-root users, which can be done by adding a 'USER' statement to the Dockerfile.",
    "file": "test_data/basic.Dockerfile"
  },
  {
    "code": "DS026",
    "level": "LEVEL_HIGH",
    "linter": "trivy",
    "targetType": "docker",
    "isSecurity": true,
    "message": "You should add HEALTHCHECK instruction in your docker container images to perform the health check on running containers.",
    "file": "test_data/basic.Dockerfile"
  },
  {
    "code": "KSV003",
    "level": "LEVEL_HIGH",
    "linter": "trivy",
    "targetType": "yaml",
    "isSecurity": true,
    "message": "The container should drop all default capabilities and add only those that are needed for its execution.",
    "file": "test_data/basic.yaml"
  },
  {
    "code": "KSV011",
    "level": "LEVEL_HIGH",
    "linter": "trivy",
    "targetType": "yaml",
    "isSecurity": true,
    "message": "Enforcing CPU limits prevents DoS via resource exhaustion.",
    "file": "test_data/basic.yaml"
  },
  {
    "code": "KSV012",
    "level": "LEVEL_HIGH",
    "linter": "trivy",
    "targetType": "yaml",
    "isSecurity": true,
    "message": "'runAsNonRoot' forces the running image to run as a non-root user to ensure least privileges.",
    "file": "test_data/basic.yaml"
  },
  {
    "code": "KSV013",
    "level": "LEVEL_HIGH",
    "linter": "trivy",
    "targetType": "yaml",
    "isSecurity": true,
    "message": "It is best to avoid using the ':latest' image tag when deploying containers in production. Doing so makes it hard to track which version of the image is running, and hard to roll back the version.",
    "file": "test_data/basic.yaml"
  },
  {
    "code": "KSV014",
    "level": "LEVEL_HIGH",
    "linter": "trivy",
    "targetType": "yaml",
    "isSecurity": true,
    "message": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
    "file": "test_data/basic.yaml"
  },
  {
    "code": "KSV018",
    "level": "LEVEL_HIGH",
    "linter": "trivy",
    "targetType": "yaml",
    "isSecurity": true,
    "message": "Enforcing memory limits prevents DoS via resource exhaustion.",
    "file": "test_data/basic.yaml"
  },
  {
    "code": "KSV020",
    "level": "LEVEL_HIGH",
    "linter": "trivy",
    "targetType": "yaml",
    "isSecurity": true,
    "message": "Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.",
    "file": "test_data/basic.yaml"
  },
  {
    "code": "KSV021",
    "level": "LEVEL_HIGH",
    "linter": "trivy",
    "targetType": "yaml",
    "isSecurity": true,
    "message": "Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.",
    "file": "test_data/basic.yaml"
  },
  {
    "code": "KSV030",
    "level": "LEVEL_HIGH",
    "linter": "trivy",
    "targetType": "yaml",
    "isSecurity": true,
    "message": "The RuntimeDefault/Localhost seccomp profile must be required, or allow specific additional profiles.",
    "file": "test_data/basic.yaml"
  },
  {
    "code": "KSV106",
    "level": "LEVEL_HIGH",
    "linter": "trivy",
    "targetType": "yaml",
    "isSecurity": true,
    "message": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.",
    "file": "test_data/basic.yaml"
  },
  {
    "code": "CVE-2022-45198",
    "level": "LEVEL_HIGH",
    "linter": "trivy",
    "targetType": "lockfile",
    "isSecurity": true,
    "message": "Pillow before 9.2.0 performs Improper Handling of Highly Compressed GIF Data (Data Amplification).",
    "file": "test_data/nested/requirements.txt"
  },
  {
    "code": "CVE-2022-45198",
    "level": "LEVEL_HIGH",
    "linter": "trivy",
    "targetType": "lockfile",
    "isSecurity": true,
    "message": "Pillow before 9.2.0 performs Improper Handling of Highly Compressed GIF Data (Data Amplification).",
    "file": "test_data/requirements.txt"
  }
]
